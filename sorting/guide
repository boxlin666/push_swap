function push_swap(stack_a):
    sorted_array = sort(stack_a)
    total_size = len(stack_a)

    # ğŸ§© é€‰æ‹© chunk æ•°é‡ï¼ŒåŠ¨æ€è®¾ç½®
    num_chunks = choose_chunk_count(total_size)
    chunk_size = total_size / num_chunks

    # ğŸ” å¯¹æ¯ä¸ª chunk å¤„ç†
    for i in range(num_chunks):
        min_val = sorted_array[i * chunk_size]
        max_val = sorted_array[(i + 1) * chunk_size - 1]

        # ğŸ” æ‰¾æ‰€æœ‰å±äºå½“å‰ chunk çš„å…ƒç´ 
        while exists_chunk_element(stack_a, min_val, max_val):
            index = find_best_index(stack_a, min_val, max_val)

            # ğŸš€ å°†å®ƒæ—‹è½¬åˆ°é¡¶éƒ¨
            rotate_to_top(stack_a, index)

            # ğŸ§  å†³å®šæ˜¯å¦ rb
            value = stack_a.top()
            push_b()
            if value < median(min_val, max_val):
                rotate_b()  # å°çš„è½¬åˆ°åº•éƒ¨
            # å¦åˆ™å¤§çš„ç•™åœ¨é¡¶éƒ¨

    # âœ… B ä¸­æ‰€æœ‰å…ƒç´ å·²æ¨å®Œï¼Œç°åœ¨ä» B å›å½’ A
    while stack_b is not empty:
        max_index = find_max_index(stack_b)
        if max_index <= len(stack_b) / 2:
            repeat max_index times:
                rotate_b()
        else:
            repeat (len(stack_b) - max_index) times:
                reverse_rotate_b()
        push_a()